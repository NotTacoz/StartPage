<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta content="New Tab" property="og:title" />
    <meta
      content="Easy, Clean and Customisable Searchbar"
      property="og:description"
    />
    <meta content="#1e1e32" data-react-helmet="true" name="theme-color" />

    <title>New Tab</title>
  </head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <script>
    function getWeatherData() {
      $(document).ready(async function () {
        var city = undefined;
        await fetch("https://ipinfo.io/json")
          .then(function (response) {
            return response.json();
          })
          .then(function (myJson) {
            city = myJson.city;
            console.log;
          })
          .catch(function (error) {
            console.log("Error: " + error);
          });
        $.getJSON(
          "https://api.weatherapi.com/v1/current.json?key=76aa7ac854eb413c82565451211807&q=" +
            city,
          function (data) {}
        )
          .done(function (data) {
            $("#weather").text(
              data.current.condition.text + " " + data.current.temp_c + "Â°C"
            );
          })
          .fail(function (data) {});
      });
    }

    openSettingsTab = function () {
      // console.log("pog");
      // if timebg is hidden
      if ($("#timebg").css("display") == "none") {
        $("#timebg").show();
        $("#settings").hide();
      } else if ($("#timebg").css("display") == "block") {
        $("#timebg").hide();
        $("#settings").show();
      }
    };

    function updateTime() {
      $(document).ready(function () {
        var currentTime = new Date();
        var hours = currentTime.getHours();
        var minutes = currentTime.getMinutes();
        var day = currentTime.getDay();
        var date = currentTime.getDate();
        var month = currentTime.getMonth();
        // convert day to text
        var days = [
          "Sunday",
          "Monday",
          "Tuesday",
          "Wednesday",
          "Thursday",
          "Friday",
          "Saturday",
        ];
        var dayText = days[day];
        // add contraction to date
        var dateText = date + "";
        if (date === 1) {
          dateText = date + "st";
        } else if (date === 2) {
          dateText = date + "nd";
        } else if (date === 3) {
          dateText = date + "rd";
        } else if (date < 21) {
          dateText = date + "th";
        }

        // convert month to text
        var months = [
          "January",
          "February",
          "March",
          "April",
          "May",
          "June",
          "July",
          "August",
          "September",
          "October",
          "November",
          "December",
        ];
        var monthText = months[month];
        // convert date to text

        // console.log(d_str);

        if (minutes < 10) {
          minutes = "0" + minutes;
        }

        // console.log(hours);

        // update bgimg based on time
        var bgimg = "";
        if (hours >= 7 && hours < 9) {
          bgimg = "img/sunset.jpg";
        } else if (hours >= 9 && hours < 18) {
          bgimg = "img/day.jpg";
        } else if (hours >= 18 && hours < 21) {
          bgimg = "img/sunset.jpg";
        } else if (hours >= 21 && hours < 24) {
          bgimg = "img/night.jpg";
        } else if (hours >= 0 && hours < 6) {
          bgimg = "img/night.jpg";
        }
        document.getElementById("bgimg").src = bgimg;

        if (hours > 12) {
          var AMPM = "PM";
          hours -= 12;
        } else {
          var AMPM = "AM";
        }
        var d_str = dayText + ", " + dateText + " " + monthText;
        var t_str = hours + ":" + minutes + " " + AMPM;

        $("#time").text(t_str);
        $("#date").text(d_str);
      });
    }
    updateTime(); // immeditatelly runs the function, so that there is no lag
    getWeatherData();
    setInterval(updateTime, 1000);
    setInterval(getWeatherData, 900000); // 15 minutes

    var r = document.querySelector(":root");
    r.style.setProperty("--blue", "lightblue");
    //set every element to be unable to be dragged
    var elements = document.getElementsByClassName("draggable");
    for (var i = 0; i < elements.length; i++) {
      elements[i].setAttribute("draggable", "false");
    }
  </script>

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap");
    :root {
      --dark-bg: rgb(25, 25, 30);
      --text-color: white;
      --image-opacity: 0.5;
      --bg-opacity: 0.4;
      --bg-effect: none;
      --font-size: 1rem;
      --font-weight: 400;
      --font-size-large: calc(5 * var(--font-size));
      --font-size-medium: calc(1.5 * var(--font-size));
    }

    * {
      /* transition: 0.4s ease-out; */
      font-family: "Roboto Mono";
      font-weight: var(--font-weight);
      font-size: var(--font-size);
      margin: 0px;
      padding: 0px;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 1.2rem;
      height: 1.2rem;
      left: 1rem;
    }

    /* Hide default HTML checkbox */
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    body {
      background: var(--bg-effect);
      background-color: var(--dark-bg);
      color: var(--text-color);
      width: 100%;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow: hidden;
      justify-content: center;
    }

    .settings {
      opacity: 20%;
      width: 3rem;
      bottom: 1rem;
      left: 1rem;
      position: fixed;
    }

    .settings:hover {
      opacity: 100%;
    }

    .center {
      /* display: flex; */
      text-align: center;
      justify-content: center;
      align-items: center;
    }

    button {
      display: inline-block;
    }

    .large {
      font-size: var(--font-size-large);
    }

    .medium {
      font-size: var(--font-size-medium);
    }

    /* search bar css */
    .search-bar {
      color: var(--text-color);
      display: fixed;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 2rem;
      margin-top: 2rem;
      width: 32rem;
      font-size: larger;
      background-color: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      border: 0px;
      padding: 1rem;
      /* transition: 0.4s ease-out; */
    }

    .search-bar::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .search-bar:focus {
      outline: 0px;
    }

    .image {
      /* transition: ease-in-out 0.4s; */
      opacity: var(--image-opacity);
      z-index: -1;
      position: absolute;
      height: 100%;
      width: 100%;
    }

    .timebg {
      background-color: rgba(0, 0, 0, var(--bg-opacity));
      padding: 3rem;
      border-radius: 25px;
    }

    .slider {
      border-radius: 0.5rem;
      -webkit-appearance: none;
      width: 80%;
      height: 12px;
      margin: 10px;
      background: black;
      outline: none;
      opacity: 0.6;
      -webkit-transition: 0.2s;
      transition: opacity 0.2s;
    }

    .slider:hover {
      opacity: 0.8;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      background: #04aa6d;
      cursor: pointer;
      border-radius: 1rem;
      opacity: 100%;
    }

    .slider::-moz-range-thumb {
      width: 25px;
      opacity: 100%;
      height: 25px;
      background: #04aa6d;
      cursor: pointer;
    }
    #settings {
      overflow: auto;
      max-width: 40%;
      max-height: 70%;
    }

    ::-webkit-scrollbar {
      width: 8px; /* 1px wider than Lion. */
      /* This is more usable for users trying to click it. */
      background-color: rgba(0, 0, 0, 0);
      border-radius: 100px;
      -webkit-border-radius: 100px;
    }
    /* hover effect for both scrollbar area, and scrollbar 'thumb' */
    ::-webkit-scrollbar:hover {
      background-color: rgba(0, 0, 0, 0.09);
    }

    /* The scrollbar 'thumb' ...that marque oval shape in a scrollbar */
    ::-webkit-scrollbar-thumb:vertical {
      /* This is the EXACT color of Mac OS scrollbars. 
     Yes, I pulled out digital color meter */
      background: rgba(0, 0, 0, 0.5);
      border-radius: 100px;
      -webkit-border-radius: 100px;
    }
    ::-webkit-scrollbar-thumb:vertical:active {
      background: rgba(0, 0, 0, 0.6); /* Some darker color when you click it */
      border-radius: 100px;
      -webkit-border-radius: 100px;
    }
    /* ul remove styles */
    ul {
      list-style: none;
      margin: 1rem;
    }
    a {
      transition: ease-in 0.1s;
      color: var(--text-color);
      text-decoration: none;
      font-style: normal;
      opacity: 0.6;
    }
    a:hover {
      opacity: 1;
      font-weight: bold;
    }
  </style>

  <body>
    <div class="timebg center" id="timebg">
      <div class="center">
        <p class="medium" id="weather"></p>
        <p class="large" id="time"></p>
        <p class="medium" id="date"></p>
      </div>
      <!-- duckduckgo search -->
      <div class="center" id="" style="align-items: center">
        <input
          id="searchBar"
          type="text"
          class="search-bar"
          placeholder="Search with DuckDuckGo"
          autofocus
          autocomplete="off"
        />
      </div>
      <div style="display: flex; justify-content: center" id="easyTabs">
        <ul>
          <li class="medium" style="color: rgb(255, 137, 255)">SOCIAL</li>
          <!-- <li style="font-weight: bolder">-social-</li> -->
          <li><a href="https://discord.com/app">discord</a></li>
          <li><a href="https://youtube.com/">youtube</a></li>
          <li><a href="https://gmail.com/">gmail</a></li>
          <li><a href="https://reddit.com/">reddit</a></li>
          <li><a href="https://twitter.com/">twitter</a></li>
        </ul>
        <ul>
          <li class="medium" style="color: rgb(170, 255, 137)">SCHOOL</li>
          <li><a href="https://connect.det.wa.edu.au/">connect</a></li>
          <li>
            <a href="https://outlook.office365.com/mail/inbox">outlook</a>
          </li>
        </ul>
        <ul>
          <li class="medium" style="color: rgb(137, 237, 255)">TECH</li>
          <li><a href="https://github.com/">github</a></li>
          <li><a href="https://stackoverflow.com/">stack</a></li>
        </ul>
      </div>
    </div>
    <div
      class="timebg"
      style="
        top: 1rem;
        right: 1rem;
        position: fixed;
        width: 22%;
        padding: 1.5rem;
        max-height: 100%;
        height: 40%;
      "
      id="todo"
    >
      <!-- Hi! I'm a todo list (WIP, I'm still working on it :) ). -->
      <textarea
        style="
          overflow: auto;
          border: none;
          outline: none;
          width: 100%;
          height: 100%;
          resize: none;
          background-color: rgba(0, 0, 0, 0);
          color: white;
        "
        id="todolist"
      ></textarea>
    </div>

    <div class="timebg center" id="settings" style="display: none">
      <h1>Settings</h1>
      <!-- toggle button -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>Stripes:</p>
        <input
          id="stripestoggle"
          type="checkbox"
          class="toggle switch"
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleStripes()"
        />
      </div>
      <!-- toggle button to hide todo -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>Todo:</p>
        <input
          id="todotoggle"
          type="checkbox"
          class="toggle switch"
          checked
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleTodo()"
        />
      </div>
      <!-- toggle button to hide weather -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>Weather:</p>
        <input
          id="weathertoggle"
          type="checkbox"
          class="toggle switch"
          checked
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleWeather()"
        />
      </div>
      <!-- toggle button to hide date -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>Date:</p>
        <input
          id="datetoggle"
          type="checkbox"
          class="toggle switch"
          checked
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleDate()"
        />
      </div>
      <!-- toggle button to hide time -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>Time:</p>
        <input
          id="timetoggle"
          type="checkbox"
          class="toggle switch"
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleTime()"
          checked
        />
      </div>
      <!-- toggle button to hide easytabs -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>EasyTabs:</p>
        <input
          id="easytabstoggle"
          type="checkbox"
          class="toggle switch"
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleEasyTabs()"
          checked
        />
      </div>
      <!-- toggle button to hide searchbar -->
      <div style="display: flex; justify-content: center; align-items: center">
        <p>SearchBar:</p>
        <input
          id="searchbartoggle"
          type="checkbox"
          class="toggle switch"
          style="margin-left: 0.5rem; margin-bottom: -0.1rem"
          onchange="toggleSearchBar()"
          checked
        />
      </div>
      <p>Background Image Opacity: <span id="imageOpacitySpan"></span></p>
      <!-- slider -->
      <input
        type="range"
        min="0"
        max="100"
        value="50"
        class="slider"
        id="imageOpacitySlider"
      />
      <p>Text Background Opacity: <span id="bgOpacitySpan"></span></p>
      <input
        type="range"
        min="0"
        max="100"
        value="40"
        class="slider"
        id="bgOpacitySlider"
      />
      <p>Text Font Size: <span id="fontSizeSpan"></span></p>
      <input
        type="range"
        min="7"
        max="15"
        value="10"
        class="slider"
        id="fontSizeSlider"
      />
      <p>Text Font Weight: <span id="fontWeightSpan"></span></p>
      <input
        type="range"
        min="100"
        max="900"
        value="400"
        class="slider"
        id="fontWeightSlider"
        step="100"
      />
      <h1>Change Logs</h1>
      <p>v1.1.3 20/07/21: Added More Settings to customize font size and width!</p>
      <p>
        v1.1.2 20/07/21: Bug Fixes: Search Bar Toggle, ToDo list now saves to
        local storage!
      </p>
      <p>v1.1.1 19/07/21: Bug Fixes: Default Funkiness fixed (i think)</p>
      <p>
        v1.1.0 19/07/21: Added ability to toggle about almost everything! As
        well as a todolist which is saved onto localStorage (WIP)
      </p>
      <p>v1.0.0 19/07/21: Initial Release</p>
      <h1>Notes</h1>
      <p>
        - View at 110-125% Size for best experience.
        <br />
        - If the weather condition isn't correct. It might be because you are
        using a VPN or the weather API is down or broken.
        <br />
        - The background image can change according to the time of the day!
      </p>
      <p>copyright Tacoz 2021</p>
    </div>

    <img
      src="img/day.jpg"
      alt="day.jpg"
      style="z-index: -99"
      id="bgimg"
      class="image"
    />

    <img
      src="img/settings.png"
      alt="settings.png"
      class="settings"
      onclick="openSettingsTab()"
    />

    <script>
      //set image opacity local storage
      // console.log(localStorage)
      var localStorageImageOpacity = localStorage.getItem("image-opacity");
      var localStorageBgEffect = localStorage.getItem("bg-effect");
      var localStorageBgOpacity = localStorage.getItem("bg-opacity");
      var localStorageDate = localStorage.getItem("date");
      var localStorageTime = localStorage.getItem("time");
      var localStorageWeather = localStorage.getItem("weather");
      var localStorageTodo = localStorage.getItem("todo");
      var localStorageEasyTabs = localStorage.getItem("easyTabs");
      var localStorageSearchBar = localStorage.getItem("searchBar");
      var localStorageFontSize = localStorage.getItem("font-size");
      var localStorageFontWeight = localStorage.getItem("font-weight");

      if (localStorageBgEffect === null) {
        localStorageBgEffect = "none";
      }
      if (localStorageImageOpacity === null) {
        localStorageImageOpacity = "50";
      }
      if (localStorageBgOpacity === null) {
        localStorageBgOpacity = "40";
      }
      if (localStorageDate === null) {
        localStorageDate = "checked";
      }
      if (localStorageTime === null) {
        localStorageTime = "checked";
      }
      if (localStorageWeather === null) {
        localStorageWeather = "checked";
      }
      if (localStorageTodo === null) {
        localStorageTodo = "false";
      }
      if (localStorageEasyTabs === null) {
        localStorageEasyTabs = "checked";
      }
      if (localStorageSearchBar === null) {
        localStorageSearchBar = "checked";
      }
      if (localStorageFontSize === null) {
        localStorageFontSize = "10";
      }
      if (localStorageFontWeight === null) {
        localStorageFontWeight = "400";
      }

      if (localStorageBgEffect === "none") {
        $("#stripestoggle").prop("checked", false);
      } else {
        $("#stripestoggle").prop("checked", true);
      }
      if (localStorageDate === "checked") {
        $("#date").show();
        $("#datetoggle").prop("checked", true);
      } else {
        $("#date").hide();
        $("#datetoggle").prop("checked", false);
      }
      if (localStorageTime === "checked") {
        $("#time").show();
        $("#timetoggle").prop("checked", true);
      } else {
        $("#time").hide();
        $("#timetoggle").prop("checked", false);
      }
      if (localStorageWeather === "checked") {
        $("#weather").show();
        $("#weathertoggle").prop("checked", true);
      } else {
        $("#weather").hide();
        $("#weathertoggle").prop("checked", false);
      }
      if (localStorageTodo === "checked") {
        $("#todo").show();
        $("#todotoggle").prop("checked", true);
      } else {
        $("#todo").hide();
        $("#todotoggle").attr("checked", false);
      }
      if (localStorageEasyTabs === "checked") {
        $("#easyTabs").show();
        $("#easytabstoggle").attr("checked", true);
      } else {
        $("#easyTabs").hide();
        $("#easytabstoggle").attr("checked", false);
      }
      if (localStorageSearchBar === "checked") {
        $("#searchBar").show();
        $("#searchbartoggle").attr("checked", true);
      } else {
        $("#searchBar").hide();
        $("#searchbartoggle").attr("checked", false);
      }

      $("#imageOpacitySpan").text(localStorageImageOpacity);
      $("#bgOpacitySpan").text(localStorageBgOpacity);
      $("#imageOpacitySlider").val(localStorageImageOpacity);
      $("#bgOpacitySlider").val(localStorageBgOpacity);
      $("#fontSizeSpan").text(localStorageFontSize + "rem");
      $("#fontWeightSpan").text(localStorageFontWeight);
      $("#fontSizeSlider").val(localStorageFontSize);
      $("#fontWeightSlider").val(localStorageFontWeight);

      //set css to local storage

      document.documentElement.style.setProperty(
        "--image-opacity",
        localStorageImageOpacity / 100
      );
      document.documentElement.style.setProperty(
        "--bg-opacity",
        localStorageBgOpacity / 100
      );
      document.documentElement.style.setProperty(
        "--font-size",
        localStorageFontSize / 10 + "rem"
      );
      document.documentElement.style.setProperty(
        "--font-weight",
        localStorageFontWeight
      );
      document.documentElement.style.setProperty(
        "--bg-effect",
        localStorageBgEffect
      );

      // if enter is pressed
      $("#searchBar").keypress(function (e) {
        if (e.which === 13) {
          // console.log("amogus");
          // search with duckduckgo
          var query = $("#searchBar").val();
          if (query.length > 0) {
            window.location.href = "https://duckduckgo.com/?q=" + query;
          }
        }
      });
      // when bgOpacitySlider is being interacted
      $("#bgOpacitySlider").on("input", function () {
        $("#bgOpacitySpan").text($(this).val());
        // set css variable --bg-opacity to slider value
        //save slider to local storage
        localStorage.setItem("bg-opacity", $(this).val());
        document.documentElement.style.setProperty(
          "--bg-opacity",
          $(this).val() / 100
        );
      });
      // when imageOpacitySlider is being interacted
      $("#imageOpacitySlider").on("input", function () {
        $("#imageOpacitySpan").text($(this).val());
        //save slider to local storage
        localStorage.setItem("image-opacity", $(this).val());
        document.documentElement.style.setProperty(
          "--image-opacity",
          $(this).val() / 100
        );
      });
      // when fontSizeSlider is being interacted
      $("#fontSizeSlider").on("input", function () {
        $("#fontSizeSpan").text($(this).val());
        //save slider to local storage
        localStorage.setItem("font-size", $(this).val());
        document.documentElement.style.setProperty(
          "--font-size",
          $(this).val() / 10 + "rem"
        );
      });
      // when fontWeightSlider is being interacted
      $("#fontWeightSlider").on("input", function () {
        $("#fontWeightSpan").text($(this).val());
        //save slider to local storage
        localStorage.setItem("font-weight", $(this).val());
        document.documentElement.style.setProperty(
          "--font-weight",
          $(this).val()
        );
      });

      // save todolist to local storage when edited
      $("#todolist").on("input", function () {
        localStorage.setItem("todolist", $(this).val());
      });
      //get todolist from local storage
      var localStorageTodolist = localStorage.getItem("todolist");
      if (localStorageTodolist === null) {
        localStorageTodolist = "Todo list (Click on me): ";
      }
      $("#todolist").val(localStorageTodolist);
      //set todolist to textarea
      $("#todolist").focus();
      //set todolist to textarea
      $("#todolist").blur();

      function toggleDate() {
        if ($("#datetoggle").is(":checked")) {
          $("#date").show();
          localStorage.setItem("date", "checked");
        } else {
          $("#date").hide();
          localStorage.setItem("date", "false");
        }
      }
      function toggleSearchBar() {
        if ($("#searchbartoggle").is(":checked")) {
          $("#searchBar").show();
          localStorage.setItem("searchBar", "checked");
        } else {
          $("#searchBar").hide();
          localStorage.setItem("searchBar", "false");
        }
      }
      function toggleTodo() {
        console.log("toggleTodo");
        if ($("#todotoggle").is(":checked")) {
          $("#todo").show();
          localStorage.setItem("todo", "checked");
        } else {
          $("#todo").hide();
          localStorage.setItem("todo", "false");
        }
      }
      function toggleTime() {
        if ($("#timetoggle").is(":checked")) {
          $("#time").show();
          localStorage.setItem("time", "checked");
        } else {
          $("#time").hide();
          localStorage.setItem("time", "false");
        }
      }
      function toggleEasyTabs() {
        if ($("#easytabstoggle").is(":checked")) {
          $("#easyTabs").show();
          localStorage.setItem("easyTabs", "checked");
        } else {
          $("#easyTabs").hide();
          localStorage.setItem("easyTabs", "false");
        }
      }
      function toggleWeather() {
        if ($("#weathertoggle").is(":checked")) {
          $("#weather").show();
          localStorage.setItem("weather", "checked");
        } else {
          $("#weather").hide();
          localStorage.setItem("weather", "false");
        }
      }
      // when toggle is clicked
      function toggleStripes() {
        if ($("#stripestoggle").is(":checked")) {
          // change css variable bg-effect to "stripes"
          document.documentElement.style.setProperty(
            "--bg-effect",
            "repeating-linear-gradient(45deg, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6) 50px, rgba(0, 0, 0, 0.4) 50px, rgba(0, 0, 0, 0.4) 100px"
          );
          // save to local storage
          localStorage.setItem(
            "bg-effect",
            "repeating-linear-gradient(45deg, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6) 50px, rgba(0, 0, 0, 0.4) 50px, rgba(0, 0, 0, 0.4) 100px"
          );
        } else {
          // change css variable bg-effect to "none"
          document.documentElement.style.setProperty("--bg-effect", "none");
          //save to local storage
          localStorage.setItem("bg-effect", "none");
        }
      }
    </script>
  </body>
</html>
